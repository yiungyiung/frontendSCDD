<!--

<div class="container">
  <div class="row">
    <div class="col-md-3">
      <div class="add-vendor-card">
        <div class="card-header-container">
          <h4 class="card-header">
            {{
              selectedVendor
                ? "Update Supply Chain Partner"
                : "Add Supply Chain Partner"
            }}
          </h4>
          <mat-icon
            *ngIf="selectedVendor == null"
            svgIcon="uploadButton"
            (click)="toggleFileUpload()"
          ></mat-icon>
          <mat-icon
            *ngIf="selectedVendor"
            type="button"
            (click)="resetSelectedVendor()"
            svgIcon="reset"
          ></mat-icon>
        </div>
        <form [formGroup]="vendorForm" (ngSubmit)="onSubmit()">
          <div class="form-group">
            <label for="vendorName">Supply Chain Partner Name</label>
            <input
              type="text"
              id="vendorName"
              formControlName="vendorName"
              class="form-control"
            />
            <div
              *ngIf="
                vendorForm.get('vendorName')?.invalid &&
                (vendorForm.get('vendorName')?.dirty ||
                  vendorForm.get('vendorName')?.touched)
              "
              class="error"
            >
              Vendor Name is required.
            </div>
          </div>
          <div class="form-group">
            <label for="vendorRegNumber">Vendor Registration Number</label>
            <input
              type="text"
              id="vendorRegNumber"
              formControlName="vendorRegistration"
              class="form-control"
            />
            <div
              *ngIf="
                vendorForm.get('vendorRegistration')?.invalid &&
                (vendorForm.get('vendorRegistration')?.dirty ||
                  vendorForm.get('vendorRegistration')?.touched)
              "
              class="error"
            >
              Vendor Registration Number is required.
            </div>
          </div>
          <div class="form-group">
            <label for="vendorAddress">Vendor Address</label>
            <input
              type="text"
              id="vendorAddress"
              formControlName="vendorAddress"
              class="form-control"
            />
            <div
              *ngIf="
                vendorForm.get('vendorAddress')?.invalid &&
                (vendorForm.get('vendorAddress')?.dirty ||
                  vendorForm.get('vendorAddress')?.touched)
              "
              class="error"
            >
              Vendor Address is required.
            </div>
          </div>
          <div class="form-group">
            <label for="contactPerson">Name of Contact Person</label>
            <input
              type="text"
              id="contactPerson"
              formControlName="contactName"
              class="form-control"
            />
            <div
              *ngIf="
                vendorForm.get('contactName')?.invalid &&
                (vendorForm.get('contactName')?.dirty ||
                  vendorForm.get('contactName')?.touched)
              "
              class="error"
            >
              Contact Person is required.
            </div>
          </div>
          <div class="form-group">
            <label for="emailID">Email ID of Contact Person</label>
            <input
              type="email"
              id="emailID"
              formControlName="email"
              class="form-control"
            />
            <div
              *ngIf="
                vendorForm.get('email')?.invalid &&
                (vendorForm.get('email')?.dirty ||
                  vendorForm.get('email')?.touched)
              "
              class="error"
            >
              Valid Email ID is required.
            </div>
          </div>
          <div class="form-group">
            <label for="contactNumber">Contact Number</label>
            <input
              type="tel"
              id="contactNumber"
              formControlName="contactNumber"
              class="form-control"
            />
            <div
              *ngIf="
                vendorForm.get('contactNumber')?.invalid &&
                (vendorForm.get('contactNumber')?.dirty ||
                  vendorForm.get('contactNumber')?.touched)
              "
              class="error"
            >
              Contact Number is required.
            </div>
          </div>
          <div class="form-group">
            <label for="category">Category of Industry</label>
            <select
              id="category"
              formControlName="categoryID"
              class="form-control"
            >
              <option value="">Select Category</option>
              <option
                *ngFor="let category of categories"
                [value]="category.categoryID"
              >
                {{ category.categoryName }}
              </option>
            </select>
            <div
              *ngIf="
                vendorForm.get('categoryID')?.invalid &&
                (vendorForm.get('categoryID')?.dirty ||
                  vendorForm.get('categoryID')?.touched)
              "
              class="error"
            >
              Category is required.
            </div>
          </div>
          <div class="form-group">
            <label for="tier">Tier</label>
            <select
              id="tier"
              formControlName="tierID"
              class="form-control"
              (change)="onTierChange($event)"
            >
              <option value="">Select Tier</option>
              <option *ngFor="let tier of tiers" [value]="tier.tierId">
                {{ tier.tierName }}
              </option>
            </select>
            <div
              *ngIf="
                vendorForm.get('tierID')?.invalid &&
                (vendorForm.get('tierID')?.dirty ||
                  vendorForm.get('tierID')?.touched)
              "
              class="error"
            >
              Tier is required.
            </div>
          </div>
          <div class="form-group" *ngIf="tier1Vendors.length > 0">
            <mat-form-field class="mat-form-field">
              <div class="search-container">
                <input
                  matInput
                  placeholder="Search vendors"
                  [(ngModel)]="searchQuery"
                  [ngModelOptions]="{ standalone: true }"
                  class="search-input"
                />
                <button class="search-button">
                  <mat-icon svgIcon="searchIcon"></mat-icon>
                </button>
              </div>
            </mat-form-field>
            <div class="vendor-list">
              <div *ngFor="let vendor of filteredVendors" class="form-check">
                <input
                  type="checkbox"
                  class="form-check-input"
                  [id]="vendor.vendorID"
                  [value]="vendor.vendorID"
                  (change)="toggleSelection(vendor.vendorID!, $event)"
                />
                <label class="form-check-label" [for]="vendor.vendorID">{{
                  vendor.vendorName
                }}</label>
              </div>
            </div>
          </div>
          <button
            type="submit"
            class="btn btn-primary"
            [disabled]="vendorForm.invalid"
          >
            Submit
          </button>
        </form>
        <app-popup-box></app-popup-box>
      </div>
    </div>

    <div class="col-md-9">
      <div class="back-card mb-3">
        <div class="card-header-container">
          <h4>Supply Chain Partners</h4>

          <div class="icon-container ml-auto">
            <mat-icon
              svgIcon="exportButton"
              (click)="openExportModal()"
            ></mat-icon>
            <app-exportDialogBox
              [selectedColumns]="selectedColumns"
              [allColumns]="allColumns"
              [data]="vendors"
            ></app-exportDialogBox>
            <mat-icon
              [ngClass]="{ 'filter-applied': isFilterApplied() }"
              svgIcon="filterIcon"
              (click)="toggleFilterVisibility()"
            ></mat-icon>

            <app-pagination
              [currentPage]="currentPage"
              [totalPages]="totalPages"
              [itemsPerPage]="itemsPerPage"
              [totalItems]="totalItems"
              (pageChange)="onPageChange($event)"
              (itemsPerPageChange)="onItemsPerPageChange($event)"
            ></app-pagination>
          </div>
        </div>

        <div class="container">
          <app-vendorcard
            *ngFor="let vendor of filteredVendor"
            [vendor]="vendor"
            [toggleVendorStatus]="toggleVendorStatus.bind(this)"
          ></app-vendorcard>
        </div>
      </div>
    </div>
  </div>
  <div *ngIf="isFilterVisible">
    <app-filter
      [subParts]="filterSubParts"
      (close)="closeFilter()"
      (filterChange)="onFilterChange($event)"
    ></app-filter>
  </div>
  <div *ngIf="showFileUpload" class="file-upload-wrapper">
    <app-fileUpload
      [TemplateHeader]="csvHeaders"
      (fileParsed)="onFileParsed($event)"
      (cancel)="onCancelFileUpload()"
    ></app-fileUpload>
  </div>
  <app-FileUploadStatus
    [failedUsers]="failedUsersUpload"
  ></app-FileUploadStatus>
</div>


-->

<!-- User Management Component -->
<div class="container">
  <div class="row">
    <!-- User Form Section -->

    <div class="col-md-6">
      <div class="card mb-3">
        <div class="add-vendor-card">
          <!-- parent.component.html -->

          <div class="card-header-container">
            <h4 class="card-header">
              {{
                selectedVendor
                  ? "Update Supply Chain Partner"
                  : "Add Supply Chain Partner"
              }}
            </h4>
            <mat-icon
              *ngIf="selectedVendor == null"
              svgIcon="uploadButton"
              (click)="toggleFileUpload()"
            ></mat-icon>
            <mat-icon
              *ngIf="selectedVendor"
              type="button"
              (click)="resetSelectedVendor()"
              svgIcon="reset"
            ></mat-icon>
          </div>
          <form [formGroup]="vendorForm" (ngSubmit)="onSubmit()">
            <div class="form-group">
              <label for="vendorName">Supply Chain Partner Name</label>
              <input
                type="text"
                id="vendorName"
                formControlName="vendorName"
                class="form-control"
              />
              <div
                *ngIf="
                  vendorForm.get('vendorName')?.invalid &&
                  (vendorForm.get('vendorName')?.dirty ||
                    vendorForm.get('vendorName')?.touched)
                "
                class="error"
              >
                Vendor Name is required.
              </div>
            </div>
            <div class="form-group">
              <label for="vendorRegNumber">Vendor Registration Number</label>
              <input
                type="text"
                id="vendorRegNumber"
                formControlName="vendorRegistration"
                class="form-control"
              />
              <div
                *ngIf="
                  vendorForm.get('vendorRegistration')?.invalid &&
                  (vendorForm.get('vendorRegistration')?.dirty ||
                    vendorForm.get('vendorRegistration')?.touched)
                "
                class="error"
              >
                Vendor Registration Number is required.
              </div>
            </div>
            <div class="form-group">
              <label for="vendorAddress">Vendor Address</label>
              <input
                type="text"
                id="vendorAddress"
                formControlName="vendorAddress"
                class="form-control"
              />
              <div
                *ngIf="
                  vendorForm.get('vendorAddress')?.invalid &&
                  (vendorForm.get('vendorAddress')?.dirty ||
                    vendorForm.get('vendorAddress')?.touched)
                "
                class="error"
              >
                Vendor Address is required.
              </div>
            </div>
            <div class="form-group">
              <label for="contactPerson">Name of Contact Person</label>
              <input
                type="text"
                id="contactPerson"
                formControlName="contactName"
                class="form-control"
              />
              <div
                *ngIf="
                  vendorForm.get('contactName')?.invalid &&
                  (vendorForm.get('contactName')?.dirty ||
                    vendorForm.get('contactName')?.touched)
                "
                class="error"
              >
                Contact Person is required.
              </div>
            </div>
            <div class="form-group">
              <label for="emailID">Email ID of Contact Person</label>
              <input
                type="email"
                id="emailID"
                formControlName="email"
                class="form-control"
              />
              <div
                *ngIf="
                  vendorForm.get('email')?.invalid &&
                  (vendorForm.get('email')?.dirty ||
                    vendorForm.get('email')?.touched)
                "
                class="error"
              >
                Valid Email ID is required.
              </div>
            </div>
            <div class="form-group">
              <label for="contactNumber">Contact Number</label>
              <input
                type="tel"
                id="contactNumber"
                formControlName="contactNumber"
                class="form-control"
              />
              <div
                *ngIf="
                  vendorForm.get('contactNumber')?.invalid &&
                  (vendorForm.get('contactNumber')?.dirty ||
                    vendorForm.get('contactNumber')?.touched)
                "
                class="error"
              >
                Contact Number is required.
              </div>
            </div>
            <div class="form-group">
              <label for="category">Category of Industry</label>
              <select
                id="category"
                formControlName="categoryID"
                class="form-control"
              >
                <option value="">Select Category</option>
                <option
                  *ngFor="let category of categories"
                  [value]="category.categoryID"
                >
                  {{ category.categoryName }}
                </option>
              </select>
              <div
                *ngIf="
                  vendorForm.get('categoryID')?.invalid &&
                  (vendorForm.get('categoryID')?.dirty ||
                    vendorForm.get('categoryID')?.touched)
                "
                class="error"
              >
                Category is required.
              </div>
            </div>
            <div class="form-group">
              <label for="tier">Tier</label>
              <select
                id="tier"
                formControlName="tierID"
                class="form-control"
                (change)="onTierChange($event)"
              >
                <option value="">Select Tier</option>
                <option *ngFor="let tier of tiers" [value]="tier.tierId">
                  {{ tier.tierName }}
                </option>
              </select>
              <div
                *ngIf="
                  vendorForm.get('tierID')?.invalid &&
                  (vendorForm.get('tierID')?.dirty ||
                    vendorForm.get('tierID')?.touched)
                "
                class="error"
              >
                Tier is required.
              </div>
            </div>
            <div class="form-group" *ngIf="tier1Vendors.length > 0">
              <mat-form-field class="mat-form-field">
                <div class="search-container">
                  <input
                    matInput
                    placeholder="Search vendors"
                    [(ngModel)]="searchQuery"
                    [ngModelOptions]="{ standalone: true }"
                    class="search-input"
                  />
                  <button class="search-button">
                    <mat-icon svgIcon="searchIcon"></mat-icon>
                  </button>
                </div>
              </mat-form-field>
              <div class="vendor-list">
                <div *ngFor="let vendor of filteredVendors" class="form-check">
                  <input
                    type="checkbox"
                    class="form-check-input"
                    [id]="vendor.vendorID"
                    [value]="vendor.vendorID"
                    (change)="toggleSelection(vendor.vendorID!, $event)"
                  />
                  <label class="form-check-label" [for]="vendor.vendorID">{{
                    vendor.vendorName
                  }}</label>
                </div>
              </div>
            </div>
            <button
              type="submit"
              class="btn btn-primary"
              [disabled]="vendorForm.invalid"
            >
              Submit
            </button>
          </form>
          <app-popup-box></app-popup-box>
        </div>
      </div>
    </div>
    <!-- User List Section -->
    <div class="col-md-6">
      <div class="back-card mb-3">
        <div class="card-header-container">
          <h4 class="card-header">Supply Chain Partners</h4>

          <div class="icon-container ml-auto">
            <mat-icon
              svgIcon="exportButton"
              (click)="openExportModal()"
            ></mat-icon>
            <app-exportDialogBox
              [selectedColumns]="selectedColumns"
              [allColumns]="allColumns"
              [data]="vendors"
            ></app-exportDialogBox>
            <mat-icon
              [ngClass]="{ 'filter-applied': isFilterApplied() }"
              svgIcon="filterIcon"
              (click)="toggleFilterVisibility()"
            ></mat-icon>
            <app-pagination
              [currentPage]="currentPage"
              [totalPages]="totalPages"
              [itemsPerPage]="itemsPerPage"
              [totalItems]="totalItems"
              (pageChange)="onPageChange($event)"
              (itemsPerPageChange)="onItemsPerPageChange($event)"
            ></app-pagination>
          </div>
        </div>

        <div class="container">
          <app-vendorcard
            *ngFor="let vendor of filteredVendor"
            [vendor]="vendor"
            [toggleVendorStatus]="toggleVendorStatus.bind(this)"
          ></app-vendorcard>
        </div>
        <div *ngIf="isFilterVisible">
          <app-filter
            [subParts]="filterSubParts"
            (close)="closeFilter()"
            (filterChange)="onFilterChange($event)"
          ></app-filter>
        </div>
        <div *ngIf="showFileUpload" class="file-upload-wrapper">
          <app-fileUpload
            [TemplateHeader]="csvHeaders"
            (fileParsed)="onFileParsed($event)"
            (cancel)="onCancelFileUpload()"
          ></app-fileUpload>
        </div>
        <app-FileUploadStatus
          [failedUsers]="failedUsersUpload"
        ></app-FileUploadStatus>
      </div>
    </div>
  </div>
</div>
